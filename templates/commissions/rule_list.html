{% extends "ui/module_content.html" %}
{% load i18n %}

{% block tabbar %}
    {% include "commissions/partials/tabbar.html" with active_tab="rules" %}
{% endblock %}

{% block header_actions %}
<ion-button href="/modules/commissions/rules/create/">
    <ion-icon slot="icon-only" name="add-outline"></ion-icon>
</ion-button>
{% endblock %}

{% block page_content %}
<div class="p-md">
    <ion-list lines="full">
        {% for rule in rules %}
        <ion-item href="/modules/commissions/rules/{{ rule.id }}/" class="list-item-clickable">
            <ion-label>
                <h2>{{ rule.name }}</h2>
                <p>{{ rule.get_rule_type_display }} - 
                    {% if rule.rule_type == 'flat' %}${{ rule.flat_amount }}
                    {% else %}{{ rule.rate }}%{% endif %}
                </p>
                {% if rule.description %}
                <p class="text-secondary">{{ rule.description|truncatewords:10 }}</p>
                {% endif %}
            </ion-label>
            <div slot="end">
                <ion-badge color="{% if rule.is_active %}success{% else %}medium{% endif %}">
                    {% if rule.is_active %}{% trans "Active" %}{% else %}{% trans "Inactive" %}{% endif %}
                </ion-badge>
            </div>
        </ion-item>
        {% empty %}
        <ion-item>
            <ion-label class="text-center text-secondary py-lg">
                <ion-icon name="options-outline" class="text-xl mb-sm"></ion-icon>
                <p>{% trans "No rules configured" %}</p>
                <ion-button href="/modules/commissions/rules/create/" fill="clear">
                    {% trans "Create your first rule" %}
                </ion-button>
            </ion-label>
        </ion-item>
        {% endfor %}
    </ion-list>
</div>
{% endblock %}
