{% extends "ui/module_content.html" %}
{% load i18n %}

{% block tabbar %}
    {% include "commissions/partials/tabbar.html" with active_tab="transactions" %}
{% endblock %}

{% block header_actions %}
<ion-button href="/modules/commissions/adjustments/create/">
    <ion-icon slot="icon-only" name="add-outline"></ion-icon>
</ion-button>
{% endblock %}

{% block page_content %}
<div class="p-md">
    <!-- Filters -->
    <div class="flex gap-sm mb-md">
        <ion-chip {% if not status_filter %}color="primary"{% endif %}>
            <a href="?status=">{% trans "All" %}</a>
        </ion-chip>
        <ion-chip {% if status_filter == 'pending' %}color="primary"{% endif %}>
            <a href="?status=pending">{% trans "Pending" %}</a>
        </ion-chip>
        <ion-chip {% if status_filter == 'approved' %}color="primary"{% endif %}>
            <a href="?status=approved">{% trans "Approved" %}</a>
        </ion-chip>
        <ion-chip {% if status_filter == 'paid' %}color="primary"{% endif %}>
            <a href="?status=paid">{% trans "Paid" %}</a>
        </ion-chip>
    </div>

    <!-- Transaction List -->
    <ion-list lines="full">
        {% for trans in transactions %}
        <ion-item href="/modules/commissions/transactions/{{ trans.id }}/" class="list-item-clickable">
            <ion-label>
                <h2>{{ trans.staff_member }}</h2>
                <p>{{ trans.transaction_type|title }} - {{ trans.transaction_date }}</p>
                <p class="text-secondary">{{ trans.reference_type }}: {{ trans.reference_id }}</p>
            </ion-label>
            <div slot="end" class="text-right">
                <div class="font-bold">${{ trans.commission_amount }}</div>
                <ion-badge color="{% if trans.status == 'approved' %}success{% elif trans.status == 'pending' %}warning{% elif trans.status == 'paid' %}primary{% elif trans.status == 'rejected' %}danger{% else %}medium{% endif %}">
                    {{ trans.status|title }}
                </ion-badge>
            </div>
        </ion-item>
        {% empty %}
        <ion-item>
            <ion-label class="text-center text-secondary py-lg">
                <ion-icon name="receipt-outline" class="text-xl mb-sm"></ion-icon>
                <p>{% trans "No transactions found" %}</p>
            </ion-label>
        </ion-item>
        {% endfor %}
    </ion-list>
</div>
{% endblock %}
