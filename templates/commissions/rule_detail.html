{% extends "ui/module_content.html" %}
{% load i18n %}

{% block tabbar %}
    {% include "commissions/partials/tabbar.html" with active_tab="rules" %}
{% endblock %}

{% block header_actions %}
<ion-button href="/modules/commissions/rules/{{ rule.id }}/edit/">
    <ion-icon slot="icon-only" name="create-outline"></ion-icon>
</ion-button>
{% endblock %}

{% block page_content %}
<div class="p-md">
    <ion-card>
        <ion-card-header>
            <ion-card-subtitle>{% trans "Commission Rule" %}</ion-card-subtitle>
            <ion-card-title>{{ rule.name }}</ion-card-title>
        </ion-card-header>
        <ion-card-content>
            <ion-list lines="none">
                <ion-item>
                    <ion-label>{% trans "Type" %}</ion-label>
                    <ion-note slot="end">{{ rule.get_rule_type_display }}</ion-note>
                </ion-item>
                {% if rule.rule_type == 'flat' %}
                <ion-item>
                    <ion-label>{% trans "Amount" %}</ion-label>
                    <ion-note slot="end" class="font-bold">${{ rule.flat_amount }}</ion-note>
                </ion-item>
                {% else %}
                <ion-item>
                    <ion-label>{% trans "Rate" %}</ion-label>
                    <ion-note slot="end" class="font-bold">{{ rule.rate }}%</ion-note>
                </ion-item>
                {% endif %}
                <ion-item>
                    <ion-label>{% trans "Priority" %}</ion-label>
                    <ion-note slot="end">{{ rule.priority }}</ion-note>
                </ion-item>
                <ion-item>
                    <ion-label>{% trans "Status" %}</ion-label>
                    <ion-badge slot="end" color="{% if rule.is_active %}success{% else %}medium{% endif %}">
                        {% if rule.is_active %}{% trans "Active" %}{% else %}{% trans "Inactive" %}{% endif %}
                    </ion-badge>
                </ion-item>
                {% if rule.description %}
                <ion-item>
                    <ion-label class="ion-text-wrap">
                        <p class="text-secondary">{% trans "Description" %}</p>
                        <p>{{ rule.description }}</p>
                    </ion-label>
                </ion-item>
                {% endif %}
                {% if rule.effective_from %}
                <ion-item>
                    <ion-label>{% trans "Effective From" %}</ion-label>
                    <ion-note slot="end">{{ rule.effective_from }}</ion-note>
                </ion-item>
                {% endif %}
                {% if rule.effective_until %}
                <ion-item>
                    <ion-label>{% trans "Effective Until" %}</ion-label>
                    <ion-note slot="end">{{ rule.effective_until }}</ion-note>
                </ion-item>
                {% endif %}
            </ion-list>
        </ion-card-content>
    </ion-card>

    <div class="flex gap-md mt-md">
        <form method="post" action="{% url 'commissions:rule_toggle' rule.id %}" class="flex-1">
            {% csrf_token %}
            <ion-button expand="block" color="{% if rule.is_active %}medium{% else %}success{% endif %}" type="submit">
                {% if rule.is_active %}{% trans "Deactivate" %}{% else %}{% trans "Activate" %}{% endif %}
            </ion-button>
        </form>
        <ion-button href="/modules/commissions/rules/{{ rule.id }}/edit/" expand="block" class="flex-1">
            <ion-icon slot="start" name="create-outline"></ion-icon>
            {% trans "Edit" %}
        </ion-button>
    </div>
</div>
{% endblock %}
